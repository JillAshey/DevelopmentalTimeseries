---
title: "lncRNA - mRNA interactions"
author: "Jill Ashey"
date: "2024-11-13"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```


Looking at lncRNA mRNA correlations 
```{r}
lcount <- read.csv("../output/Molecular/lncRNA/lncRNA_filtered_counts.csv")[90:110,]
rownames(lcount) <- lcount[,1] #set first column that contains gene names as rownames
lcount <- lcount[,-1] # remove column w/ gene names 

mcount <- read.csv("../output/Molecular/mRNA/mRNA_filtered_counts.csv")[100:120,]
rownames(mcount) <- mcount[,1] #set first column that contains gene names as rownames
mcount <- mcount[,-1] # remove column w/ gene names 

lcount_numeric <- apply(lcount, 2, as.numeric)
mcount_numeric <- apply(mcount, 2, as.numeric)

calculate_pcc <- function(lncRNA, mRNA) {
  result <- cor.test(lncRNA, mRNA, method = "pearson")
  return(c(pcc = result$estimate, p_value = result$p.value))
}

results <- list()
for (i in 1:nrow(lcount_numeric)) {
  lncRNA <- lcount_numeric[i,]
  for (j in 1:nrow(mcount_numeric)) {
    mRNA <- mcount_numeric[j,]
    results[[paste(rownames(lcount)[i], rownames(mcount)[j], sep = "_")]] <- calculate_pcc(lncRNA, mRNA)
  }
}

results_df <- do.call(rbind, results)
results_df <- as.data.frame(results_df)
results_df$lncRNA_mRNA <- rownames(results_df)
rownames(results_df) <- NULL

co_expressed_pairs <- results_df[abs(results_df$pcc) > -0.3 & results_df$p_value < 0.05, ]
co_expressed_pairs <- results_df[results_df$p_value < 0.05, ]
```

Huang et al. 2017 used abs value of correlation as 0.95
Lopes et al. 2019 used 0.8
Yin et al. 2020 (oral cancer) used top 0.05 percentile

